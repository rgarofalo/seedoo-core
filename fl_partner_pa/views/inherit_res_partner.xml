<?xml version="1.0" encoding="utf-8" ?>

<odoo>
    <data noupdate="0">

        <record id="view_res_partner_form" model="ir.ui.view">
            <field name="name">view.res.partner.form</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='is_company']" position="after">
                    <group invisible="1">
                        <field name="contact_pa_type"/>
                        <field name="is_private_company"/>
                        <field name="is_pa"/>
                        <field name="is_amm"/>
                        <field name="is_gps"/>
                        <field name="is_aoo"/>
                        <field name="is_uo"/>
                        <field name="create_uid"/>
                        <field name="phone_invisible"/>
                        <field name="mobile_invisible"/>
                        <field name="title_invisible"/>
                        <field name="street2_invisible"/>
                        <field name="fiscalcode_invisible"/>
                        <field name="vat_invisible"/>
                        <field name="category_id_invisible"/>
                        <field name="website_invisible"/>
                        <field name="company_type_invisible"/>
                        <field name="company_subject_type_invisible"/>
                        <field name="amministrazione_id_invisible"/>
                        <field name="aoo_id_invisible"/>
                        <field name="create_date"/>
                        <field name="email_invisible"/>
                        <field name="lang_invisible"/>
                        <field name="uo_ids_invisible"/>
                        <field name="pa_digital_domicile_ids_invisible"/>
                        <field name="aoo_digital_domicile_ids_invisible"/>
                        <field name="uo_digital_domicile_ids_invisible"/>
                    </group>
                </xpath>

                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="attrs">{'required': [('type','=','contact')]}</attribute>
                    <attribute name="force_save">1</attribute>
                </xpath>

                <xpath expr="//field[@name='company_type']" position="after">
                    <field name="company_subject_type"
                           placeholder="Typology"
                           attrs="{'required': [('company_type','=','company')], 'invisible': ['|', '|', ('company_type','!=','company'), ('contact_pa_type','!=',False), ('company_subject_type_invisible','=',True)]}"
                    />
                </xpath>

                <xpath expr="//field[@name='parent_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='parent_id']" position="after">
                    <field name="parent_personal_id"
                           widget="res_partner_many2one"
                           placeholder="Company / PA / GPS / AOO / UO"
                           domain="['|', '|', '|', '|', ('is_private_company','=',True), ('is_amm','=',True), ('is_gps','=',True), ('is_aoo','=',True), ('is_uo','=',True)]"
                           attrs="{'invisible': ['|', ('company_type','=','company'), ('company_subject_type','!=',False)]}"
                           context="{'default_company_type': 'company', 'default_company_subject_type': 'private'}"
                    />
                    <field name="parent_company_id"
                           widget="res_partner_many2one"
                           placeholder="Company"
                           domain="[('is_private_company','=',True)]"
                           attrs="{'invisible': [('is_private_company','=',False)]}"
                           context="{'default_company_type_invisible': True, 'default_company_type': 'company', 'default_company_subject_type_invisible': True, 'default_company_subject_type': 'private'}"
                    />
                    <field name="amministrazione_id"
                           placeholder="PA / GPS"
                           domain="[('company_subject_type','=',company_subject_type),'|','|',('is_private_company','=',True),('is_amm','=',True),('is_gps','=',True)]"
                           attrs="{'invisible': [('amministrazione_id_invisible','=',True)], 'required': [('amministrazione_id_invisible','=',False)]}"
                           context="{'default_company_type_invisible': True, 'default_company_subject_type_invisible': True}"
                           options="{'no_create': True}"
                    />
                    <field name="aoo_id"
                           placeholder="Homogeneous Organizational Areas"
                           attrs="{'invisible': [('aoo_id_invisible','=',True)], 'required': [('aoo_id_invisible','=',False)]}"
                           context="{'default_company_type_invisible': True, 'default_company_subject_type_invisible': True}"
                           options="{'always_reload': True, 'no_create': True}"
                    />
                </xpath>

                <xpath expr="//field[@name='category_id']" position="after">
                    <field name="cod_amm"
                           attrs="{'invisible': [('is_amm','=',False), ('is_gps','=',False)]}"
                    />
                    <field name="cod_aoo"
                           attrs="{'invisible': [('is_aoo','=', False)]}"
                    />
                    <field name="cod_ou"
                           attrs="{'invisible': [('is_uo','=', False)]}"
                    />
                </xpath>

                <xpath expr="//field[@name='category_id']/.." position="after">
                    <group colspan="2">
                        <field name="pa_digital_domicile_ids"
                               attrs="{'invisible': [('pa_digital_domicile_ids_invisible','=',True)]}"
                               context="{'tree_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_tree_aoo', 'form_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_form_aoo'}"
                        />
                        <field name="aoo_digital_domicile_ids"
                               attrs="{'invisible': [('aoo_digital_domicile_ids_invisible','=',True)]}"
                               context="{'tree_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_tree', 'form_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_form'}"
                        />
                        <field name="uo_digital_domicile_ids"
                               attrs="{'invisible': [('uo_digital_domicile_ids_invisible','=',True)]}"
                               context="{'tree_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_tree', 'form_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_form'}"
                        />
                        <field name="email_address_ids"
                               attrs="{'invisible': [('is_uo','=', False)]}"
                        />
                    </group>
                </xpath>

                <xpath expr="//label[@for='email']" position="attributes">
                    <attribute name="attrs">{'invisible': [('email_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='email']" position="attributes">
                    <attribute name="attrs">{'required': [('user_ids','!=', [])], 'invisible': [('email_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='phone']" position="attributes">
                    <attribute name="attrs">{'invisible': [('phone_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='company_type']" position="attributes">
                    <attribute name="attrs">{'invisible': [('company_type_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='mobile']" position="attributes">
                    <attribute name="attrs">{'invisible': [('mobile_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='title']" position="attributes">
                    <attribute name="attrs">{'invisible': [('title_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='street2']" position="attributes">
                    <attribute name="attrs">{'invisible': [('street2_invisible', '=', True)],'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='vat']" position="attributes">
                    <attribute name="attrs">{'invisible': [('vat_invisible', '=', True)],'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='category_id']" position="attributes">
                    <attribute name="attrs">{'invisible': [('category_id_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='type']" position="attributes">
                    <attribute name="attrs">{'invisible': [('company_type', '!=', 'person')],
                                             'readonly': [('user_ids', '!=', [])]}</attribute>
                </xpath>

                <xpath expr="//field[@name='website']" position="attributes">
                    <attribute name="attrs">{'invisible': [('website_invisible', '=', True)]}</attribute>
                </xpath>

                <xpath expr="//label[@for='lang']" position="attributes">
                    <attribute name="attrs">{'invisible': ['|', ('lang_invisible', '=', True), ('active_lang_count', '&lt;=', 1)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='lang']/.." position="attributes">
                    <attribute name="attrs">{'invisible': ['|', ('lang_invisible', '=', True), ('active_lang_count', '&lt;=', 1)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='function']" position="attributes">
                    <attribute name="attrs">{'invisible': [('company_type', '!=', 'person')]}</attribute>
                </xpath>

                <xpath expr="//field[@name='parent_id']" position="attributes">
                    <attribute name="attrs">{
                        'invisible': [('company_type', 'not in', ['person', 'company'])]}</attribute>
                </xpath>

                <xpath expr="//field[@name='child_ids']//form//field[@name='name']" position="before">
                </xpath>

                <!-- remove default_type from context -->
                <xpath expr="//field[@name='child_ids']" position="attributes">
                    <attribute name="context">{'default_parent_id': active_id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_lang': lang, 'default_user_id': user_id}</attribute>
                </xpath>

                <xpath expr="//field[@name='child_ids']//form//hr" position="after">
                    <group col="12" attrs="{'invisible': [('parent_child_aoo_id_invisible','=',True), ('parent_child_uo_id_invisible','=',True)]}">
                        <group colspan="12" >
                            <field name="parent_child_aoo_id"
                                   domain="[('is_aoo','=',True),('amministrazione_id','=',context.get('default_parent_id'))]"
                                   attrs="{'invisible': [('parent_child_aoo_id_invisible','=',True)]}"
                                   options="{'no_open': True, 'no_create': True}"
                            />
                            <field name="parent_child_uo_id"
                                   domain="[('is_uo','=',True),'|',('amministrazione_id','=',context.get('default_parent_id')),('aoo_id','=',context.get('default_parent_id'))]"
                                   attrs="{'invisible': [('parent_child_uo_id_invisible','=',True)]}"
                                   options="{'no_open': True, 'no_create': True}"
                            />
                            <field name="parent_child_aoo_id_invisible" invisible="1"/>
                            <field name="parent_child_uo_id_invisible" invisible="1"/>
                        </group>
                    </group>
                </xpath>

                <xpath expr="//field[@name='child_ids']//kanban//div[@class='oe_kanban_details']//field[@name='name']" position="replace">
                    <strong class="o_kanban_record_title oe_partner_heading">
                        <b><field name="name"/></b>
                    </strong>
                </xpath>

                <xpath expr="//page[@name='contact_addresses']" position="after">
                    <field name="id" invisible="1"/>
                    <page string="Homogeneous Organizational Areas" name="aoo_ids"
                          attrs="{'invisible':[('is_amm','=',False),('is_gps','=',False)]}">
                        <field name="aoo_ids"
                               nolabel="1"
                               options="{'no_create':True}"
                               mode="kanban"
                               context="{
                               'kanban_view_ref': 'fl_partner_pa.view_res_partner_kanban2',
                               'form_view_ref': 'fl_partner_pa.view_res_partner_form2',
                               'default_is_company': True,
                               'default_company_subject_type': company_subject_type,
                               'default_contact_pa_type': 'aoo',
                               'default_amministrazione_id': active_id,
                               'aoo_id_invisible': True,
                               'aoo_id_required': False,
                               }"
                        />
                    </page>
                    <page string="Organizational Unit"
                          name="uo_ids"
                          attrs="{'invisible': [('is_private_company','=',False),('is_aoo','=',False),('is_amm','=',False),('is_gps','=',False)]}">

                        <field name="uo_ids" nolabel="1"
                               attrs="{'invisible': [('uo_ids_invisible','=',True)]}"
                               options="{'no_create':False}"
                               mode="kanban"
                               context="{
                               'kanban_view_ref': 'fl_partner_pa.view_res_partner_kanban2',
                               'form_view_ref': 'fl_partner_pa.view_res_partner_form2',
                               'default_is_company': True,
                               'default_company_subject_type': company_subject_type,
                               'default_contact_pa_type': 'uo',
                               'amministrazione_id': id,
                               'aoo_id_invisible': is_private_company,
                               'aoo_id_required': is_pa,
                               'from_pa': True,
                               }"
                        />

                        <field name="aoo_uo_ids" nolabel="1"
                               attrs="{'invisible': [('is_aoo','=',False)]}"
                               options="{'no_create':False}"
                               mode="kanban"
                               context="{
                               'kanban_view_ref': 'fl_partner_pa.view_res_partner_kanban2',
                               'form_view_ref': 'fl_partner_pa.view_res_partner_form2',
                               'default_is_company': True,
                               'default_company_subject_type': company_subject_type,
                               'default_contact_pa_type': 'uo',
                               'default_amministrazione_id': amministrazione_id,
                               'default_aoo_id': active_id,
                               'amministrazione_id': amministrazione_id,
                               'aoo_id_invisible': True,
                               'aoo_id_required': False,
                               }"
                        />

                    </page>
                </xpath>

            </field>
        </record>

        <record id="view_partner_form_fiscalcode_data" model="ir.ui.view">
            <field name="name">view.res.partner.form</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="fl_partner_cf.view_partner_form_fiscalcode_data"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='fiscalcode']" position="after">
                    <field name="fiscalcode_invisible" invisible="1"/>
                </xpath>

                <!-- Estensione per il campo fiscalcode di fl_partner_cf -->
                <xpath expr="//label[@name='fl_fiscalcode']" position="attributes">
                    <attribute name="attrs">{'invisible': ['|',('fl_fiscalcode_invisible', '=', True), ('fiscalcode_invisible', '=', True)]}</attribute>
                </xpath>
                <xpath expr="//div[@name='fl_fiscalcode']" position="attributes">
                    <attribute name="attrs">{'invisible': ['|',('fl_fiscalcode_invisible', '=', True), ('fiscalcode_invisible', '=', True)]}</attribute>
                </xpath>

            </field>
        </record>

        <record id="view_res_partner_form_simple" model="ir.ui.view">
            <field name="name">view.res.partner.form.simple</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_simple_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='is_company']" position="after">
                    <group>
                        <field name="is_amm" invisible="1"/>
                        <field name="is_gps" invisible="1"/>
                        <field name="is_aoo" invisible="1"/>
                        <field name="is_uo" invisible="1"/>
                    </group>
                </xpath>

                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="attrs">{'required': [('type','=','contact')]}</attribute>
                </xpath>

            </field>
        </record>

        <record id="view_res_partner_form2" model="ir.ui.view">
            <field name="name">view.res.partner.form2</field>
            <field name="model">res.partner</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name"
                                       string="Name"
                                       required="1"
                                       default_focus="1"
                                       placeholder="Name"
                                />
                            </h1>
                        </div>
                        <group invisible="1">
                            <field name="phone_invisible"/>
                            <field name="mobile_invisible"/>
                            <field name="title_invisible"/>
                            <field name="street2_invisible"/>
                            <field name="fiscalcode_invisible"/>
                            <field name="vat_invisible"/>
                            <field name="category_id_invisible"/>
                            <field name="website_invisible"/>
                            <field name="email_invisible"/>
                            <field name="fl_pec_mail_required"/>
                            <field name="fl_pec_mail_invisible"/>
                            <field name="is_company"/>
                            <field name="company_subject_type"/>
                            <field name="contact_pa_type"/>
                            <field name="is_pa"/>
                        </group>
                        <group col="12">
                            <group colspan="12">
                                <field name="amministrazione_id"
                                       options="{'no_open':True, 'no_create':True}"
                                       invisible="1"
                                       readonly="0"
                                />
                                <field name="aoo_id"
                                       options="{'no_open':True, 'no_create':True, 'always_reload': True}"
                                       invisible="context.get('aoo_id_invisible', 1)"
                                       required="context.get('aoo_id_required', 1)"
                                />
                            </group>
                        </group>
                        <group col="12">
                            <group colspan="6">
                                <field name="fiscalcode" attrs="{'invisible': [('fiscalcode_invisible','=', True)]}"/>
                                <label for="street" string="Address"/>
                                <div class="o_address_format" name="div_address">
                                    <field name="street" placeholder="Street..." class="o_address_street"/>
                                    <field name="city" placeholder="City" class="o_address_city"/>
                                    <field name="state_id" class="o_address_state" placeholder="State"
                                           options="{'no_open': True, 'no_quick_create': True}"
                                           context="{'country_id': country_id, 'default_country_id': country_id, 'zip': zip}"/>
                                    <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                    <field name="country_id" placeholder="Country" class="o_address_country"
                                           options='{"no_open": True, "no_create": True}'/>
                                </div>
                                <field name="vat" attrs="{'invisible': [('vat_invisible','=', True)]}"/>
                            </group>
                            <group colspan="6">
                                <field name="phone" widget="phone"
                                       attrs="{'invisible': [('phone_invisible','=', True)]}"/>
                                <field name="mobile" widget="phone"
                                       attrs="{'invisible': [('mobile_invisible','=', True)]}"/>
                                <field name="email" widget="email" attrs="{'invisible': [('email_invisible','=', True)]}"/>
                                <field name="pec_mail" widget="email"
                                       attrs="{'invisible': [('fl_pec_mail_invisible','=', True)]}"
                                />
                                <field name="website" attrs="{'invisible': [('website_invisible','=', True)]}"/>
                                <field name="category_id"
                                       widget="many2many_tags"
                                       options="{'color_field': 'color', 'no_create_edit': True}"
                                       placeholder="Tags..."
                                       attrs="{'invisible': [('category_id_invisible','=', True)]}"
                                />
                                <field name="company_id" invisible="1"/>
                                <field name="cod_amm"
                                       attrs="{'invisible': [('contact_pa_type','!=',False)]}"
                                />
                                <field name="cod_aoo"
                                       attrs="{'invisible': [('contact_pa_type','!=','aoo')]}"
                                />
                                <field name="cod_ou"
                                       attrs="{'invisible': [('contact_pa_type','!=','uo')]}"
                                />
                            </group>
                            <group colspan="12">
                                <field name="aoo_digital_domicile_ids"
                                       attrs="{'invisible': [('contact_pa_type','!=','aoo')]}"
                                       context="{'tree_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_tree', 'form_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_form'}"
                                />
                                <field name="uo_digital_domicile_ids"
                                       attrs="{'invisible': [('contact_pa_type','!=','uo')]}"
                                       context="{'tree_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_tree', 'form_view_ref': 'fl_partner_pa.view_res_partner_digital_domicile_form'}"
                                />
                                <field name="email_address_ids"
                                       attrs="{'invisible': [('contact_pa_type','!=','uo')]}"
                                />
                            </group>
                        </group>
                        <field name="lang" invisible="True"/>
                        <field name="user_id" invisible="True"/>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_res_partner_kanban2" model="ir.ui.view">
            <field name="name">view.res.partner.kanban2</field>
            <field name="model">res.partner</field>
            <field name="arch" type="xml">
                <kanban>
                    <field name="id"/>
                    <field name="color"/>
                    <field name="title"/>
                    <field name="type"/>
                    <field name="name"/>
                    <field name="aoo_id"/>
                    <field name="amministrazione_id"/>
                    <field name="email"/>
                    <field name="pec_mail"/>
                    <field name="function"/>
                    <field name="phone"/>
                    <field name="street"/>
                    <field name="street2"/>
                    <field name="zip"/>
                    <field name="city"/>
                    <field name="country_id"/>
                    <field name="mobile"/>
                    <field name="state_id"/>
                    <field name="image_128"/>
                    <field name="lang"/>
                    <field name="comment"/>
                    <field name="display_name"/>
                    <field name="is_amm"/>
                    <field name="is_gps"/>
                    <field name="is_aoo"/>
                    <field name="is_uo"/>
                    <field name="digital_domicile_ids_html"/>
                    <field name="email_address_ids_html"/>
                    <templates>
                        <t t-name="kanban-box">
                            <t t-set="color" t-value="kanban_color(record.color.raw_value)"/>
                            <div t-att-class="color + (record.title.raw_value == 1 ? ' oe_kanban_color_alert' : '') + ' oe_kanban_global_click'">
                                <div class="o_kanban_image">
                                    <img alt="Contact image" t-if="record.image_128.raw_value"
                                         t-att-src="kanban_image('res.partner', 'image_128', record.id.raw_value)"/>
                                    <t t-if="!record.image_128.raw_value">
                                        <t t-if="record.is_amm.raw_value or record.is_gps.raw_value"
                                           t-set="placeholder"
                                           t-value="'/fl_partner_pa/static/img/PAGPS.png'"/>
                                        <t t-elif="record.is_aoo.raw_value"
                                           t-set="placeholder"
                                           t-value="'/fl_partner_pa/static/img/AOO.png'"/>
                                        <t t-elif="record.is_uo.raw_value"
                                           t-set="placeholder"
                                           t-value="'/fl_partner_pa/static/img/UO.png'"/>
                                        <img alt="Logo"
                                             t-att-src='_s + placeholder'/>
                                    </t>
                                </div>
                                <div class="oe_kanban_details">
                                    <strong class="o_kanban_record_title oe_partner_heading">
                                        <b><field name="name"/></b>
                                    </strong>
                                    <ul>
                                        <li t-if="record.pec_mail.raw_value" class="break_word"><field name="pec_mail" widget="email"/></li>
                                        <li t-if="record.email.raw_value" class="break_word"><field name="email" widget="email"/></li>
                                        <li t-if="record.digital_domicile_ids_html.raw_value" class="break_word">
                                            <b>Digital domiciles</b>: <t t-esc="record.digital_domicile_ids_html.raw_value"/>
                                        </li>
                                        <li t-if="record.email_address_ids_html.raw_value" class="break_word">
                                            <b>Other e-mail PEC addresses</b>: <t t-esc="record.email_address_ids_html.raw_value"/>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <record id="view_res_partner_kanban" model="ir.ui.view">
            <field name="name">view.res.partner.kanban</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.res_partner_kanban_view"/>
            <field name="arch" type="xml">
                <xpath expr="//kanban" position="inside">
                    <field name="is_private_company"/>
                    <field name="is_amm"/>
                    <field name="is_gps"/>
                    <field name="is_aoo"/>
                    <field name="is_uo"/>
                    <field name="parent_amm_name"/>
                    <field name="parent_gps_name"/>
                    <field name="parent_aoo_name"/>
                    <field name="parent_uo_name"/>
                    <field name="name"/>
                    <field name="display_name_html"/>
                    <field name="digital_domicile_ids_html"/>
                    <field name="email_address_ids_html"/>
                </xpath>

                <xpath expr="//kanban/templates/t/div//strong[@class='o_kanban_record_title oe_partner_heading']"
                       position="replace">
                    <strong class="o_kanban_record_title oe_partner_heading">
                        <t t-if="record.display_name_html.raw_value">
                            <t t-raw="record.display_name_html.raw_value"/>
                        </t>
                        <t t-else="">
                            <b><field name="name"/></b>
                        </t>
                    </strong>
                </xpath>

                <xpath expr='//kanban/templates/t/div/t[@t-if="!record.is_company.raw_value"]' position="replace">
                    <t t-if="!record.is_private_company.raw_value">
                        <t t-if="record.type.raw_value === 'delivery'" t-set="placeholder"
                           t-value="'/base/static/img/truck.png'"/>
                        <t t-elif="record.type.raw_value === 'invoice'" t-set="placeholder"
                           t-value="'/base/static/img/money.png'"/>
                        <t t-elif="record.is_amm.raw_value or record.is_gps.raw_value"
                           t-set="placeholder"
                           t-value="'/fl_partner_pa/static/img/PAGPS.png'"/>
                        <t t-elif="record.is_aoo.raw_value"
                           t-set="placeholder"
                           t-value="'/fl_partner_pa/static/img/AOO.png'"/>
                        <t t-elif="record.is_uo.raw_value"
                           t-set="placeholder"
                           t-value="'/fl_partner_pa/static/img/UO.png'"/>
                        <t t-else="" t-set="placeholder" t-value="'/base/static/img/avatar_grey.png'"/>
                        <div class="o_kanban_image_fill_left d-none d-md-block"
                             t-attf-style="background-image:url('#{kanban_image('res.partner', 'image_128', record.id.raw_value,  placeholder)}')">
                            <img class="o_kanban_image_inner_pic" t-if="record.parent_id.raw_value"
                                 t-att-alt="record.parent_id.value"
                                 t-att-src="kanban_image('res.partner', 'image_128', record.parent_id.raw_value)"/>
                        </div>
                        <div class="o_kanban_image d-md-none"
                             t-attf-style="background-image:url('#{kanban_image('res.partner', 'image_128', record.id.raw_value,  placeholder)}')">
                            <img class="o_kanban_image_inner_pic" t-if="record.parent_id.raw_value"
                                 t-att-alt="record.parent_id.value"
                                 t-att-src="kanban_image('res.partner', 'image_128', record.parent_id.raw_value)"/>
                        </div>
                    </t>
                </xpath>
                <!--Eliminazione del campo parent_id dalla vista kanban-->
                <xpath expr='//kanban/templates/t/div/div/ul/li[@t-if="record.parent_id.raw_value and !record.function.raw_value"]'
                       position="replace"
                />
                <!--Aggiunta della 'sezione' PA nella vista kanban -->
                <xpath expr='//kanban/templates/t/div/div/ul' position="inside">
                    <li t-if="record.parent_amm_name.raw_value" class="break_word">
                        <b>PA</b>: <t t-esc="record.parent_amm_name.raw_value"/>
                    </li>
                    <li t-if="record.parent_gps_name.raw_value" class="break_word">
                        <b>GPS</b>: <t t-esc="record.parent_gps_name.raw_value"/>
                    </li>
                    <li t-if="record.parent_aoo_name.raw_value" class="break_word">
                        <b>AOO</b>: <t t-esc="record.parent_aoo_name.raw_value"/>
                    </li>
                    <li t-if="record.digital_domicile_ids_html.raw_value" class="break_word">
                        <b>Digital domiciles</b>: <t t-esc="record.digital_domicile_ids_html.raw_value"/>
                    </li>
                    <li t-if="record.parent_uo_name.value" class="break_word">
                        <b>UO</b>: <t t-esc="record.parent_uo_name.raw_value"/>
                    </li>
                    <li t-if="record.email_address_ids_html.raw_value" class="break_word">
                        <b>Other e-mail PEC addresses</b>: <t t-esc="record.email_address_ids_html.raw_value"/>
                    </li>
                </xpath>

            </field>
        </record>

        <record id="view_res_partner_search" model="ir.ui.view">
            <field name="name">view.res.partner.search</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_res_partner_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='type_person']" position="attributes">
                     <attribute name="domain">[('is_pa', '=', False),('is_company', '=', False)]</attribute>
                </xpath>
                <xpath expr="//search" position="inside">
                    <field name="company_type"/>
                    <field name="is_private_company"/>
                    <field name="is_amm"/>
                    <field name="is_gps"/>
                    <field name="is_aoo"/>
                    <field name="is_uo"/>
                    <field name="amministrazione_id"/>
                    <field name="aoo_id"/>
                    <field name="cod_amm"/>
                    <field name="cod_aoo"/>
                    <field name="cod_ou"/>
                    <field name="email_address_ids" string="Other e-mail PEC address" filter_domain="[('email_address_ids.email_address', 'ilike', self)]"/>
                    <field name="filter_res_partner_with_digital_domicile" string="Digital domicile" filter_domain="[('filter_res_partner_with_digital_domicile', 'ilike', self)]"/>
                </xpath>
                <xpath expr="//filter[@name='type_company']" position="after">
                    <separator/>
                    <filter string="Private Company" name="type_private" domain="[('is_private_company','=',True)]"/>
                    <filter string="Public Administration" name="type_amm" domain="[('is_amm','=',True)]"/>
                    <filter string="Public Service Manager" name="type_gps" domain="[('is_gps','=',True)]"/>
                    <filter string="Homogeneous Organizational Area" name="type_aoo" domain="[('is_aoo','=',True)]"/>
                    <filter string="Organizational Unit" name="type_ou" domain="[('is_uo','=',True)]"/>
                    <separator/>
                </xpath>
                <xpath expr="//filter[@name='group_country']" position="after">
                    <separator/>
                    <filter name="group_amministrazione"
                            string="PA / GPS"
                            context="{'group_by': 'amministrazione_id'}"
                    />
                    <filter name="group_aoo"
                            string="AOO"
                            context="{'group_by': 'aoo_id'}"
                    />
                </xpath>
            </field>
        </record>

    </data>
</odoo>